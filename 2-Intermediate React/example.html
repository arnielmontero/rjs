<!--
This uses React via CDN, so you can run it directly in your browser.
Note: SWR, React Query, Formik, and React Hook Form require installation and are not included in this HTML CDN demo, but youâ€™ll see the core patterns for each topic.
-->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Intermediate React Example</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-router-dom@6/umd/react-router-dom.development.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 2em; }
    nav a { margin-right: 1em; }
    section { margin-bottom: 2em; }
    .card { border: 1px solid #ccc; padding: 16px; margin-bottom: 1em; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/javascript">
    const { useState, useEffect, useRef, useContext, createContext } = React;
    const { BrowserRouter, Routes, Route, Link } = ReactRouterDOM;

    // a. Hooks
    // i. useState, useEffect, useContext
    function Counter() {
      const [count, setCount] = useState(0);
      useEffect(() => {
        document.title = `Count: ${count}`;
      }, [count]);
      return (
        <div className="card">
          <h3>useState & useEffect</h3>
          <p>Count: {count}</p>
          <button onClick={() => setCount(count + 1)}>Increment</button>
        </div>
      );
    }

    // Context API
    const ThemeContext = createContext();
    function ThemeProvider({ children }) {
      const [theme, setTheme] = useState('light');
      return (
        <ThemeContext.Provider value={{ theme, setTheme }}>
          {children}
        </ThemeContext.Provider>
      );
    }
    function ThemeToggler() {
      const { theme, setTheme } = useContext(ThemeContext);
      return (
        <div className="card">
          <h3>useContext (Theme)</h3>
          <p>Current theme: {theme}</p>
          <button onClick={() => setTheme(theme === 'light' ? 'dark' : 'light')}>
            Switch to {theme === 'light' ? 'dark' : 'light'} mode
          </button>
        </div>
      );
    }

    // ii. Custom Hook
    function useWindowWidth() {
      const [width, setWidth] = useState(window.innerWidth);
      useEffect(() => {
        function handleResize() {
          setWidth(window.innerWidth);
        }
        window.addEventListener('resize', handleResize);
        return () => window.removeEventListener('resize', handleResize);
      }, []);
      return width;
    }
    function ShowWidth() {
      const width = useWindowWidth();
      return (
        <div className="card">
          <h3>Custom Hook (useWindowWidth)</h3>
          <p>Window width: {width}px</p>
        </div>
      );
    }

    // b. Component Composition
    // Children
    function Card({ children }) {
      return <div className="card">{children}</div>;
    }
    // Render Props
    function DataProvider({ render }) {
      const data = "Hello from DataProvider!";
      return render(data);
    }
    // HOC
    function withLogger(WrappedComponent) {
      return function(props) {
        console.log('Props:', props);
        return <WrappedComponent {...props} />;
      };
    }
    function Hello({ name }) {
      return <h4>Hello, {name}!</h4>;
    }
    const HelloWithLogger = withLogger(Hello);

    // c. Context API (already shown above)

    // d. Forms
    // i. Controlled
    function ControlledForm() {
      const [value, setValue] = useState('');
      function handleChange(e) {
        setValue(e.target.value);
      }
      function handleSubmit(e) {
        e.preventDefault();
        alert('Controlled Submitted: ' + value);
      }
      return (
        <div className="card">
          <h3>Controlled Form</h3>
          <form onSubmit={handleSubmit}>
            <input value={value} onChange={handleChange} />
            <button type="submit">Submit</button>
          </form>
        </div>
      );
    }
    // ii. Uncontrolled
    function UncontrolledForm() {
      const inputRef = useRef();
      function handleSubmit(e) {
        e.preventDefault();
        alert('Uncontrolled Submitted: ' + inputRef.current.value);
      }
      return (
        <div className="card">
          <h3>Uncontrolled Form</h3>
          <form onSubmit={handleSubmit}>
            <input ref={inputRef} />
            <button type="submit">Submit</button>
          </form>
        </div>
      );
    }

    // e. Routing (React Router v6+)
    function Home() {
      return <h2>Home Page</h2>;
    }
    function About() {
      return <h2>About Page</h2>;
    }

    // f. Fetching Data (Fetch API)
    function FetchExample() {
      const [data, setData] = useState(null);
      useEffect(() => {
        fetch('https://jsonplaceholder.typicode.com/posts/1')
          .then(res => res.json())
          .then(setData);
      }, []);
      return (
        <div className="card">
          <h3>Fetch API Example</h3>
          {data ? <div>{data.title}</div> : <div>Loading...</div>}
        </div>
      );
    }

    // Main App
    function Main() {
      return (
        <ThemeProvider>
          <nav>
            <Link to="/">Home</Link>
            <Link to="/about">About</Link>
          </nav>
          <Routes>
            <Route path="/" element={
              <section>
                <Counter />
                <ThemeToggler />
                <ShowWidth />
                <Card>
                  <h3>Component Composition (Children)</h3>
                  <p>This is inside the Card component.</p>
                </Card>
                <Card>
                  <h3>Component Composition (Render Props)</h3>
                  <DataProvider render={data => <div>{data}</div>} />
                </Card>
                <Card>
                  <h3>Component Composition (HOC)</h3>
                  <HelloWithLogger name="Alice" />
                </Card>
                <ControlledForm />
                <UncontrolledForm />
                <FetchExample />
              </section>
            } />
            <Route path="/about" element={<About />} />
          </Routes>
        </ThemeProvider>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(
      <BrowserRouter>
        <Main />
      </BrowserRouter>
    );
  </script>
</body>
</html>